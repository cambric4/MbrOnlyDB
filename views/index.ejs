<%- include('_header', { title: 'Members Only Club' }) %>

    <h2>Club Messages</h2>

    <% if (messages.length === 0) { %>
        <p>No messages yet. Be the first to post!</p>
    <% } %>

    <div class="messages">
        <% messages.forEach(message => { %>
            <div class="message-card">
                <h3><%= message.title %></h3>
                <p><%= message.text %></p>
                
                <footer>
                    <% 
                        const isMember = currentUser && currentUser.membershipStatus;
                        const isAdmin = currentUser && currentUser.admin;
                        const author = message.author;
                    %>
                    
                    <p class="author-info">
                        â€” 
                        <% if (isMember) { %>
                            Author: <%= author.firstName %> <%= author.lastName %> 
                            on <%= new Date(message.timestamp).toLocaleDateString() %> 
                        <% } else { %>
                            Author: Anonymous
                        <% } %>
                    </p>

                    <% if (isAdmin) { %>
                        <form method="POST" action="/messages/<%= message.id %>/delete" style="display:inline;">
                            <button type="submit" class="btn-delete">Delete</button>
                        </form>
                    <% } %>
                </footer>
            </div>
        <% }); %>
    </div>

<%- include('_footer') %>